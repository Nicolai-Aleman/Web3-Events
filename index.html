<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Web3 Strategic Events Calendar 2026</title>

  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/ical.js@1.4.0/build/ical.min.js"></script>

  <style>
    :root{
      --bg:#f4f6f9; --card:#fff; --text:#111827; --muted:#6b7280; --border:#e5e7eb;
      --shadow:0 14px 30px rgba(17,24,39,.08); --shadow2:0 12px 24px rgba(17,24,39,.18);
      --radius:12px; --btn:#111827; --btnText:#fff; --btnSoft:#fff; --btnSoftText:#111827;
    }

    body{font-family:Arial,Helvetica,sans-serif;background:var(--bg);margin:0;padding:28px 16px;color:var(--text)}
    .wrap{max-width:1120px;margin:0 auto}
    header{display:flex;flex-direction:column;gap:10px;margin-bottom:16px}
    .topbar{display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap}
    h1{margin:0;font-size:24px;font-weight:750;letter-spacing:.2px}
    .subtitle{color:var(--muted);font-size:14px;margin:0;line-height:1.4}
    .actions{display:inline-flex;align-items:center;gap:10px;flex-wrap:wrap}

    .btn{
      appearance:none;border:1px solid var(--border);background:var(--btn);color:var(--btnText);
      border-radius:10px;padding:9px 12px;font-weight:700;cursor:pointer;font-size:13px
    }
    .btn.secondary{background:var(--btnSoft);color:var(--btnSoftText)}
    .btn:active{transform:translateY(1px)}

    #calendar{background:var(--card);padding:18px;border-radius:var(--radius);box-shadow:var(--shadow);border:1px solid var(--border)}

    /* Modal */
    .modal-overlay{
      position:fixed;inset:0;background:rgba(17,24,39,.55);display:none;align-items:center;justify-content:center;
      padding:16px;z-index:9999
    }
    .modal{
      width:min(860px,100%);background:var(--card);border-radius:14px;box-shadow:var(--shadow2);
      border:1px solid var(--border);overflow:hidden
    }
    .modal-header{
      display:flex;align-items:flex-start;justify-content:space-between;gap:14px;padding:16px 16px 10px 16px;
      border-bottom:1px solid var(--border);background:#fbfbfd
    }
    .modal-title{margin:0;font-size:18px;font-weight:750;line-height:1.3}
    .modal-meta{margin-top:6px;color:var(--muted);font-size:13px;display:flex;flex-wrap:wrap;gap:10px}
    .pill{
      display:inline-flex;align-items:center;padding:5px 10px;border:1px solid var(--border);border-radius:999px;
      background:#fff;font-size:12px;color:#374151
    }
    .modal-close{
      border:1px solid var(--border);background:#fff;border-radius:10px;padding:8px 10px;cursor:pointer;
      font-weight:750;color:#111827;font-size:13px
    }
    .modal-body{padding:14px 16px 16px 16px;display:grid;grid-template-columns:1fr;gap:12px}
    .section{border:1px solid var(--border);border-radius:12px;padding:12px;background:#fff}
    .section h3{margin:0 0 6px 0;font-size:12px;color:#374151;letter-spacing:.2px;text-transform:uppercase}
    .section p{margin:0;color:#111827;font-size:14px;line-height:1.45;white-space:pre-wrap}
    .two-col{display:grid;grid-template-columns:1fr 1fr;gap:12px}

    /* Add-to-calendar modal */
    .calendar-actions{display:grid;gap:10px}
    .small{color:var(--muted);font-size:13px;line-height:1.4}
    .urlbox{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
    .input{
      flex:1;min-width:220px;border:1px solid var(--border);border-radius:10px;padding:9px 10px;
      font-size:13px;background:#fff;color:var(--text)
    }
    .toast{
      position:fixed;bottom:18px;left:50%;transform:translateX(-50%);background:#111827;color:#fff;
      padding:10px 12px;border-radius:10px;font-size:13px;box-shadow:var(--shadow2);display:none;z-index:10000
    }

    @media (max-width:760px){
      .two-col{grid-template-columns:1fr}
      body{padding:20px 12px}
      .topbar{flex-direction:column;align-items:flex-start}
      .actions{width:100%}
    }

    /* FullCalendar polish */
    .fc .fc-toolbar-title{font-size:18px;font-weight:750}
    .fc .fc-button{border-radius:10px}
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="topbar">
        <h1>Web3 Strategic Events Calendar 2026</h1>
        <div class="actions">
          <button id="addCalendarBtn" class="btn" type="button">Add to my calendar</button>
          <button id="downloadIcsBtn" class="btn secondary" type="button">Download .ics</button>
        </div>
      </div>
      <p class="subtitle">Click any event to view details in a dedicated information window.</p>
    </header>

    <div id="calendar"></div>
  </div>

  <!-- Event Details Modal -->
  <div id="eventModalOverlay" class="modal-overlay" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="eventModalTitle">
      <div class="modal-header">
        <div>
          <h2 id="eventModalTitle" class="modal-title">Event</h2>
          <div class="modal-meta">
            <span id="eventModalDate" class="pill">Date</span>
            <span id="eventModalLocation" class="pill" style="display:none;">Location</span>
          </div>
        </div>
        <button id="eventModalClose" class="modal-close" type="button">Close</button>
      </div>

      <div class="modal-body">
        <div class="two-col">
          <div class="section">
            <h3>Primary focus</h3>
            <p id="eventModalFocus">—</p>
          </div>
          <div class="section">
            <h3>Ideal audience</h3>
            <p id="eventModalAudience">—</p>
          </div>
        </div>

        <div class="section">
          <h3>Strategic relevance</h3>
          <p id="eventModalRelevance">—</p>
        </div>

        <div class="section">
          <h3>Notes</h3>
          <p id="eventModalNotes">—</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Add to Calendar Modal -->
  <div id="calendarModalOverlay" class="modal-overlay" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="calendarModalTitle">
      <div class="modal-header">
        <div>
          <h2 id="calendarModalTitle" class="modal-title">Add the full calendar</h2>
          <div class="modal-meta">
            <span class="pill">One-click where supported</span>
            <span class="pill">Apple Calendar, Outlook, Google Calendar</span>
          </div>
        </div>
        <button id="calendarModalClose" class="modal-close" type="button">Close</button>
      </div>

      <div class="modal-body">
        <div class="section">
          <h3>Recommended</h3>
          <p class="small">
            Use “Subscribe” to keep your calendar updated automatically when this calendar changes.
            If one-click subscription is not supported on your device, download the .ics file and import it.
          </p>
          <div class="calendar-actions" style="margin-top:10px;">
            <button id="subscribeBtn" class="btn" type="button">Subscribe (automatic updates)</button>
            <button id="calendarDownloadBtn" class="btn secondary" type="button">Download .ics (manual import)</button>
          </div>
        </div>

        <div class="section">
          <h3>Google Calendar (subscription URL)</h3>
          <p class="small">
            Google Calendar subscriptions require adding a calendar by URL. Copy the URL below and add it in Google Calendar:
            Settings → Add calendar → From URL.
          </p>
          <div class="urlbox" style="margin-top:10px;">
            <input id="calendarUrlInput" class="input" readonly />
            <button id="copyUrlBtn" class="btn secondary" type="button">Copy URL</button>
          </div>
        </div>

        <div class="section">
          <h3>Notes</h3>
          <p class="small">
            Apple Calendar and Outlook typically support one-click subscriptions via a webcal link.
            Some browsers block custom protocols; if that happens, use “Download .ics”.
          </p>
        </div>
      </div>
    </div>
  </div>

  <div id="toast" class="toast">Copied</div>

  <script>
    // IMPORTANT:
    // Keep the ICS file in the same folder as this index.html.
    // Filename must match exactly.
    const ICS_FILENAME = "Calendario_Eventos_Web3_2026.ics";

    // Enriched event details (English). Key must match the ICS event SUMMARY exactly.
    const EVENT_DETAILS = {
      "CfC St. Moritz": {
        location: "St. Moritz, Switzerland",
        focus: "Institutional, high-level digital finance discussions.",
        audience: "Funds, private banks, family offices, and regulators.",
        relevance: "Selective setting for strategic conversations and executive positioning.",
        notes: "Best suited for CEO-level networking and confidential discussions."
      },
      "Digital Assets Forum – Londres": {
        location: "London, United Kingdom",
        focus: "Institutional infrastructure and regulation for digital assets.",
        audience: "Banks, custodians, funds, infrastructure providers.",
        relevance: "Strong TradFi lens on digital assets, useful for compliance-aligned strategy.",
        notes: "Prioritize meetings with custody, payments, and market infrastructure teams."
      },
      "Consensus Hong Kong": {
        location: "Hong Kong",
        focus: "Institutional capital and Asia-focused Web3 market structure.",
        audience: "Builders, investors, institutions, and policymakers.",
        relevance: "High signal for Asia expansion, partnerships, and regulatory alignment.",
        notes: "Use for capital conversations and cross-border distribution opportunities."
      },
      "ETHDenver": {
        location: "Denver, United States",
        focus: "Technical Web3 development and builder ecosystem.",
        audience: "Developers, protocol teams, product engineers.",
        relevance: "Best for product, engineering, and ecosystem integrations.",
        notes: "Ideal if you have a technical roadmap (wallets, rails, smart contracts, infrastructure)."
      },
      "Next Block Expo – Varsovia": {
        location: "Warsaw, Poland",
        focus: "European infrastructure, startups, and regulation.",
        audience: "Founders, operators, compliance, regional investors.",
        relevance: "Balanced event for EU ecosystem mapping and pragmatic partnerships.",
        notes: "Good for sourcing vendors, integration partners, and early-stage teams."
      },
      "Paris Blockchain Week": {
        location: "Paris, France",
        focus: "Tokenization, MiCA, and EU institutional adoption.",
        audience: "Banks, corporates, regulators, funds.",
        relevance: "Strong for tokenization, compliant stablecoin strategy, and EU market access.",
        notes: "Target side events for business development and issuer/payment conversations."
      },
      "Token2049 Dubai": {
        location: "Dubai, UAE",
        focus: "Global capital, venture, and market-level partnerships.",
        audience: "VCs, exchanges, protocols, market makers.",
        relevance: "High-density capital and deal-making environment.",
        notes: "Plan side events in advance; meetings fill quickly."
      },
      "Consensus Miami": {
        location: "Miami, United States",
        focus: "Global institutional and ecosystem convergence.",
        audience: "Regulators, institutions, founders, investors.",
        relevance: "Strong platform for executive positioning and partnerships.",
        notes: "Useful for narrative control, partnerships, and fundraising conversations."
      },
      "Stablecon EMEA – Ámsterdam": {
        location: "Amsterdam, Netherlands",
        focus: "Stablecoins, payments, regulation, and TradFi-Web3 convergence.",
        audience: "Stablecoin issuers, banks, regulators, payment operators.",
        relevance: "Key for money rails, cross-border settlement, and compliant stablecoin narratives.",
        notes: "Strong fit if your strategy involves payments, on/off-ramps, or stablecoin rails."
      },
      "Global Blockchain & Crypto Symposium – Londres": {
        location: "London, United Kingdom",
        focus: "Compliance, custody, and legal structures.",
        audience: "Legal, compliance, risk, custody providers.",
        relevance: "High value for reducing regulatory risk and strengthening governance.",
        notes: "Best attended with legal/compliance leadership and policy stakeholders."
      },
      "BTC Prague": {
        location: "Prague, Czech Republic",
        focus: "Bitcoin monetary infrastructure and long-term thinking.",
        audience: "Bitcoin builders, infrastructure teams, monetary researchers.",
        relevance: "Best for Bitcoin-aligned infrastructure and monetary-layer positioning.",
        notes: "Less relevant if your strategy is purely DeFi unless you need BTC alignment."
      },
      "European Blockchain Convention – Barcelona": {
        location: "Barcelona, Spain",
        focus: "European institutional ecosystem: banking, funds, and regulation.",
        audience: "Institutions, funds, corporates, policymakers.",
        relevance: "Strong EU networking density and regional decision-makers.",
        notes: "Recommended as a core Europe anchor event."
      },
      "Crypto Expo Dubai": {
        location: "Dubai, UAE",
        focus: "Commercial market: wallets, exchanges, and infrastructure vendors.",
        audience: "Exchanges, wallet providers, service providers.",
        relevance: "Good for distribution, vendor sourcing, and market-facing partnerships.",
        notes: "More commercial than policy-focused; choose based on go-to-market needs."
      },
      "Web Summit – Lisboa": {
        location: "Lisbon, Portugal",
        focus: "Global tech, fintech, and cross-sector partnerships.",
        audience: "Tech executives, investors, corporates.",
        relevance: "Strong for broad strategic partnerships and visibility beyond Web3.",
        notes: "Useful for positioning in fintech, AI, and enterprise integration."
      }
    };

    function pad2(n){ return String(n).padStart(2, "0"); }
    function icalDateToISODate(t){ return `${t.year}-${pad2(t.month)}-${pad2(t.day)}`; }

    function formatDisplayDate(start, end, allDay){
      const opts = { year: "numeric", month: "short", day: "2-digit" };
      const s = allDay ? new Date(start + "T00:00:00") : new Date(start);
      let e = end ? (allDay ? new Date(end + "T00:00:00") : new Date(end)) : null;
      if (!e) return s.toLocaleDateString("en-US", opts);
      if (allDay) e.setDate(e.getDate() - 1);
      if (s.toDateString() === e.toDateString()) return s.toLocaleDateString("en-US", opts);
      return `${s.toLocaleDateString("en-US", opts)} to ${e.toLocaleDateString("en-US", opts)}`;
    }

    function openOverlay(id, focusId){
      const overlay = document.getElementById(id);
      overlay.style.display = "flex";
      overlay.setAttribute("aria-hidden", "false");
      if (focusId){
        const el = document.getElementById(focusId);
        if (el) setTimeout(() => el.focus(), 0);
      }
    }

    function closeOverlay(id){
      const overlay = document.getElementById(id);
      overlay.style.display = "none";
      overlay.setAttribute("aria-hidden", "true");
    }

    function toast(msg){
      const t = document.getElementById("toast");
      t.textContent = msg;
      t.style.display = "block";
      clearTimeout(window.__toastTimer);
      window.__toastTimer = setTimeout(() => { t.style.display = "none"; }, 1400);
    }

    function getAbsoluteIcsUrl(){
      // Ensures correct URL on GitHub Pages
      const base = window.location.origin + window.location.pathname.replace(/\/[^\/]*$/, "/");
      return base + ICS_FILENAME;
    }

    function downloadIcs(){
      const a = document.createElement("a");
      a.href = ICS_FILENAME;
      a.download = ICS_FILENAME;
      document.body.appendChild(a);
      a.click();
      a.remove();
    }

    function subscribeWebcal(){
      // Works best for Apple Calendar / Outlook (subscription)
      const httpsUrl = getAbsoluteIcsUrl();
      const webcalUrl = httpsUrl.replace(/^https:\/\//i, "webcal://");
      window.location.href = webcalUrl;
    }

    document.addEventListener("DOMContentLoaded", async function () {
      // Wire buttons
      document.getElementById("downloadIcsBtn").addEventListener("click", downloadIcs);
      document.getElementById("addCalendarBtn").addEventListener("click", () => openOverlay("calendarModalOverlay", "subscribeBtn"));

      document.getElementById("calendarModalClose").addEventListener("click", () => closeOverlay("calendarModalOverlay"));
      document.getElementById("calendarDownloadBtn").addEventListener("click", downloadIcs);
      document.getElementById("subscribeBtn").addEventListener("click", subscribeWebcal);

      // Fill Google subscription URL
      document.getElementById("calendarUrlInput").value = getAbsoluteIcsUrl();

      document.getElementById("copyUrlBtn").addEventListener("click", async () => {
        const url = document.getElementById("calendarUrlInput").value;
        try{
          await navigator.clipboard.writeText(url);
          toast("Calendar URL copied");
        }catch(err){
          const input = document.getElementById("calendarUrlInput");
          input.focus();
          input.select();
          document.execCommand("copy");
          toast("Calendar URL copied");
        }
      });

      // Close modals on overlay click + Esc
      ["eventModalOverlay", "calendarModalOverlay"].forEach(id => {
        const ov = document.getElementById(id);
        ov.addEventListener("click", function(e){
          if (e.target === this) closeOverlay(id);
        });
      });

      document.addEventListener("keydown", function(e){
        if (e.key === "Escape"){
          closeOverlay("eventModalOverlay");
          closeOverlay("calendarModalOverlay");
        }
      });

      // Event modal close
      document.getElementById("eventModalClose").addEventListener("click", () => closeOverlay("eventModalOverlay"));

      // Load ICS
      const response = await fetch(ICS_FILENAME);
      const text = await response.text();

      const jcalData = ICAL.parse(text);
      const comp = new ICAL.Component(jcalData);
      const vevents = comp.getAllSubcomponents("vevent");

      // Convert ICS events to FullCalendar events
      const events = vevents.map(event => {
        const e = new ICAL.Event(event);
        const isAllDay = e.startDate && e.startDate.isDate === true;

        let startVal, endVal;
        if (isAllDay){
          startVal = icalDateToISODate(e.startDate); // YYYY-MM-DD
          endVal = e.endDate ? icalDateToISODate(e.endDate) : null; // exclusive end for all-day
        } else {
          startVal = e.startDate ? e.startDate.toJSDate().toISOString() : null;
          endVal = e.endDate ? e.endDate.toJSDate().toISOString() : null;
        }

        return {
          title: e.summary || "Event",
          start: startVal,
          end: endVal,
          allDay: isAllDay,
          extendedProps: { description: e.description || "" }
        };
      });

      // Render calendar
      const calendar = new FullCalendar.Calendar(
        document.getElementById("calendar"),
        {
          initialView: "dayGridMonth",
          initialDate: "2026-01-01",
          locale: "en",
          height: "auto",
          headerToolbar: { left: "prev,next today", center: "title", right: "dayGridMonth,listMonth" },
          events: events,
          eventClick: function(info) {
            info.jsEvent.preventDefault();

            const title = info.event.title;
            const details = EVENT_DETAILS[title] || {};

            const start = info.event.allDay ? info.event.startStr : (info.event.start ? info.event.start.toISOString() : null);
            const end = info.event.allDay ? (info.event.endStr || null) : (info.event.end ? info.event.end.toISOString() : null);
            const displayDate = formatDisplayDate(start, end, info.event.allDay);

            document.getElementById("eventModalTitle").textContent = title;
            document.getElementById("eventModalDate").textContent = displayDate;

            const locEl = document.getElementById("eventModalLocation");
            if (details.location){
              locEl.style.display = "inline-flex";
              locEl.textContent = details.location;
            } else {
              locEl.style.display = "none";
            }

            document.getElementById("eventModalFocus").textContent = details.focus || "—";
            document.getElementById("eventModalAudience").textContent = details.audience || "—";
            document.getElementById("eventModalRelevance").textContent = details.relevance || "—";
            document.getElementById("eventModalNotes").textContent = details.notes || info.event.extendedProps.description || "—";

            openOverlay("eventModalOverlay", "eventModalClose");
          }
        }
      );

      calendar.render();
    });
  </script>
</body>
</html>
